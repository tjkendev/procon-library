<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns# website: http://ogp.me/ns/website#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.7.1">
<title>写像12相 - yaketake08's 実装メモ</title>
<link rel="stylesheet" href="https://tjkendev.github.io/procon-library/src/stylesheet/github.css">
<meta property="og:title" content="写像12相 - yaketake08's 実装メモ">
<meta property="og:description" content="写像12相">
<meta property="og:type" content="article">
<meta property="og:locale" content="ja_JP">
<meta property="og:url" content="https://tjkendev.github.io/procon-library/python/combinatorics/twelvefold-way.html">
<meta name="twitter:card" content="summary">
<script type="text/javascript" src="https://tjkendev.github.io/procon-library/src/js/main.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
<link rel="stylesheet" href="https://tjkendev.github.io/procon-library/src/stylesheet/custom.css">

<style>
  .click .title { color: blue; }
  .click {margin-top: 0.5em; margin-bottom: 0.5em;}
  .openblock { margin-top: 1em; margin-bottom: 1em; }
  .openblock>.box>.content { margin-top:1em;margin-bottom: 1em;margin-left:3em;margin-right:4em; }
</style>


<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>

<script>



var ready2;

ready2 = function() {

    $(document).ready(function(){

        $('.openblock.click').click( function()  { $(this).find('.content').slideToggle('200'); } )
        $('.openblock.click').find('.content').hide()


        $('.listingblock.click').click( function()  { $(this).find('.content').slideToggle('200') }  )
        $('.listingblock.click').find('.content').hide()

    });

}




$(document).ready(ready2);
$(document).on('page:load', ready2);


</script>

</head>


<body class="article">
<div id="header">
<h1>写像12相</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>写像12相 (Twelvefold way)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_概要">概要</h2>
<div class="sectionbody">
<div class="paragraph">
<p>\(N\)個のボールを\(K\)個の箱に分けるときの通り数について</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ボールの区別する/しない</p>
</li>
<li>
<p>箱の区別する/しない</p>
</li>
<li>
<p>箱に入れる制約なし/全ての箱にボール1個以下(単射)/全ての箱にボール1個以上(全射)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>の条件で12通りの問題が考えられ、写像12相と呼ばれる。</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 75%;">
<colgroup>
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">ボールの区別</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">箱の区別</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">制約なし</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">各箱一個以下 (\(N \le K\))</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">各箱一個以上 (\(K \le N\))</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">あり</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">あり</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">\(N^K\)</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">\(_KP_N\)</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">\(\displaystyle \sum_{k=1}^K (-1)^{K-k} {}_KC_k k^N\)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">なし</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">あり</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">\({}_{N+K-1}C_N (= {}_KH_N)\)</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">\({}_KC_N\)</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">\(_{N-1}C_{K-1}\)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">あり</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">なし</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">\(B(N, K)\)</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">\(S(N, K)\)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">なし</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">なし</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">\(P(N+K, K)\)</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">\(P(N, K)\)</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_分割数_partition_number">分割数 (partition number)</h3>
<div class="paragraph">
<p>\(N\)を\(K\)個の数に区別なく分割する時の通り数: \(P(N, K)\)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(P(i, 1) = P(i, i) = 1\)</p>
</li>
<li>
<p>\(P(N, K) = P(N-K, K) + P(N-1, K-1)\)</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_実装">実装</h4>
<div class="ulist">
<ul>
<li>
<p>AOJ: "DPL_5_L: Probability - Ball and Boxes 12": <a href="http://judge.u-aizu.ac.jp/onlinejudge/review.jsp?rid=3176170#1">source</a> (Python3, 0.38sec)</p>
</li>
</ul>
</div>
<div class="listingblock">
<button type="button" class="copy-btn" data-clipboard-target=".code-idx-0">Copy to clipboard</button>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs code-idx-0" data-lang="python">N, K = map(int, input().split())
MOD = 10**9 + 7

D = [[0]*(K+1) for i in range(N+1)]
for i in range(1, N+1):
    D[i][1] = 1
for i in range(1, min(N, K)+1):
    D[i][i] = 1
for n in range(1, N+1):
    for k in range(2, min(n-1, K)+1):
        D[n][k] = (D[n-k][k] + D[n-1][k-1]) % MOD
print(D[N][K] % MOD)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_第2種スターリング数_stirling_number_of_the_second_kind">第2種スターリング数 (Stirling number of the second kind)</h3>
<div class="paragraph">
<p>区別される\(N\)個の要素を\(K\)個のグループに分割する時の通り数: \(S(N, K)\)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(S(0, 0) = 1\)</p>
</li>
<li>
<p>\(S(N, K) = S(N-1, K-1) + K * S(N-1, K)\)</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_実装_2">実装</h4>
<div class="ulist">
<ul>
<li>
<p>AOJ: "DPL_5_I: Probability - Ball and Boxes 9": <a href="http://judge.u-aizu.ac.jp/onlinejudge/review.jsp?rid=3175681#1">source</a> (Python3, 0.55sec)</p>
</li>
</ul>
</div>
<div class="listingblock">
<button type="button" class="copy-btn" data-clipboard-target=".code-idx-1">Copy to clipboard</button>
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs code-idx-1" data-lang="python">N, K = map(int, input().split())
MOD = 10**9 + 7

D = [[0]*(K+1) for i in range(N+1)]
D[0][0] = 1
for n in range(1, N+1):
    D0 = D[n-1]
    for k in range(1, K+1):
        D[n][k] = (D0[k-1] + k * D0[k]) % MOD
print(D[N][K])</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ベル数_bell_number">ベル数 (Bell number)</h3>
<div class="paragraph">
<p>区別される\(N\)個の要素を\(K\)個以下のグループに分割する時の通り数: \(B(N, K)\)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(\displaystyle B(N, K) = \sum_{k=0}^K S(N, k)\)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_参考ページ">参考ページ</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://mathtrain.jp/twelveway">写像の個数（写像12相） - 高校数学の美しい物語</a></p>
</li>
<li>
<p><a href="http://d.hatena.ne.jp/incognita/20110305/1299344781">数学ガール★分割数(partition number)の漸化式と戯れる - incognita et cognita</a></p>
</li>
</ul>
</div>
<hr>
<div class="paragraph">
<p><a href="../index.html">戻る</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-10-21 14:20:50 JST
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { extensions: ["mhchem.js"] }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>
